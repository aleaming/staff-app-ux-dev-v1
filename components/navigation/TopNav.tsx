"use client"

import { useState, useEffect } from "react"
import Link from "next/link"
import { usePathname } from "next/navigation"
import { 
  Settings, 
  Key, 
  User, 
  Bell, 
  Menu
} from "lucide-react"
import { Button } from "@/components/ui/button"
import { Avatar, AvatarFallback } from "@/components/ui/avatar"
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu"
import { Sheet, SheetContent, SheetHeader, SheetTitle, SheetTrigger } from "@/components/ui/sheet"
import { Badge } from "@/components/ui/badge"
import { SearchBar } from "./SearchBar"
import { ThemeToggle } from "@/components/theme/ThemeToggle"
import { logout, getUserEmail } from "@/lib/auth"
import { cn } from "@/lib/utils"

export function TopNav() {
  const pathname = usePathname()
  const userEmail = getUserEmail()
  const [isScrolled, setIsScrolled] = useState(false)
  const [lastScrollY, setLastScrollY] = useState(0)
  const [isVisible, setIsVisible] = useState(true)

  useEffect(() => {
    const handleScroll = () => {
      const currentScrollY = window.scrollY
      
      // Show nav when scrolling up, hide when scrolling down
      if (currentScrollY < lastScrollY || currentScrollY < 10) {
        setIsVisible(true)
      } else if (currentScrollY > lastScrollY && currentScrollY > 100) {
        setIsVisible(false)
      }
      
      setLastScrollY(currentScrollY)
      setIsScrolled(currentScrollY > 10)
    }

    window.addEventListener("scroll", handleScroll, { passive: true })
    return () => window.removeEventListener("scroll", handleScroll)
  }, [lastScrollY])

  const handleSearch = (query: string) => {
    // Navigate to search page
    window.location.href = `/search?q=${encodeURIComponent(query)}`
  }

  const handleLogout = () => {
    logout()
  }

  return (
    <header 
      className={cn(
        "sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 transition-transform duration-300",
        isVisible ? "translate-y-0" : "-translate-y-full"
      )}
    >
      <div className="container flex h-16 items-center gap-4 px-4 relative">
        {/* Mobile Menu Button - Left Side */}
        <Sheet>
          <SheetTrigger asChild className="md:hidden">
            <Button variant="ghost" size="icon">
              <Menu className="h-5 w-5" />
            </Button>
          </SheetTrigger>
              <SheetContent side="left" className="w-full max-w-[300px]">
            <SheetHeader>
              <SheetTitle>Menu</SheetTitle>
            </SheetHeader>
            <nav className="flex flex-col gap-4 mt-8">
              <Link href="/" className="mb-4">
                <svg width="180" height="46" viewBox="0 0 180 46" fill="none" xmlns="http://www.w3.org/2000/svg" className="h-8 w-auto">
                  <g clipPath="url(#clip0_152_6552_mobile)">
                    <path d="M40.4408 28.7356V19.6693C40.4408 15.9336 38.7482 14.4338 35.9715 14.4338C33.1947 14.4338 31.407 16.0288 29.8421 17.5636V14.4338H29.0434L24.6067 16.0288V16.6998L26.9052 17.8165V28.7356C26.9052 30.2054 25.8511 30.3631 24.4464 30.5559V31.6726H32.2984V30.5559C30.8612 30.3631 29.8396 30.2054 29.8396 28.7356V18.4875C31.0515 17.5286 32.8718 16.7949 34.5318 16.7949C36.5749 16.7949 37.5013 17.5937 37.5013 19.8922V28.7356C37.5013 30.2054 36.4472 30.3631 35.0426 30.5559V31.6726H42.9271V30.5559C41.4899 30.3631 40.4383 30.2054 40.4383 28.7356H40.4408Z" fill="currentColor"/>
                    <path d="M153.896 29.8849C152.97 29.8849 152.429 29.1187 152.429 27.7141C152.429 26.3094 152.524 20.8511 152.524 19.797C152.524 16.3167 150.674 14.4338 147.001 14.4338C143.52 14.4338 140.934 15.9662 140.934 18.5827C140.934 19.3488 141.157 19.8596 141.605 20.3053L143.999 19.9873C143.838 19.3488 143.776 18.8706 143.776 18.3273C143.776 16.6998 144.67 15.9637 146.392 15.9637C148.884 15.9637 149.552 17.6562 149.552 19.5717V21.1366L144.509 22.9568C142.434 23.6905 140.073 24.712 140.073 27.6815C140.073 30.0126 141.415 31.9906 144.319 31.9906C146.68 31.9906 148.5 30.3957 149.65 29.0862C149.938 30.8113 150.734 31.9906 152.364 31.9906C153.481 31.9906 154.47 31.5424 155.556 30.4583L155.396 29.6921C154.918 29.8198 154.182 29.8824 153.896 29.8824V29.8849ZM149.555 28.32C148.215 29.309 147.128 29.7572 145.629 29.7572C144.001 29.7572 143.075 28.7356 143.075 26.9154C143.075 25.7035 143.841 24.7771 145.023 24.3289L149.555 22.6063V28.32Z" fill="currentColor"/>
                    <path d="M15.8933 14.4338C11.5517 14.4338 7.94373 18.0418 7.94373 23.5327C7.94373 28.4502 10.9758 31.9931 15.7005 31.9931C20.0422 31.9931 23.6502 28.3851 23.6502 22.8942C23.6502 17.9767 20.618 14.4338 15.8933 14.4338ZM16.0836 30.3331C12.8587 30.3331 11.0084 26.9504 11.0084 22.9593C11.0084 18.9682 12.5082 16.0964 15.5103 16.0964C18.7352 16.0964 20.5855 19.479 20.5855 23.4701C20.5855 27.4612 19.0857 30.3331 16.0836 30.3331Z" fill="currentColor"/>
                    <path d="M165.897 14.7543V15.871C167.524 16.0938 168.195 16.2541 168.195 17.0202C168.195 17.2756 168.13 17.4684 167.973 17.8815L164.047 28.2874L159.833 17.8815C159.64 17.4659 159.61 17.2756 159.61 17.0202C159.61 16.2541 160.248 16.0938 161.908 15.871V14.7543H154.437V15.871C155.874 16.4143 156.002 16.4769 156.32 17.1479L162.642 31.7702L162.004 33.4628C161.365 35.218 160.566 35.6661 158.556 35.6661H156.896V37.1359C157.407 37.8069 158.3 38.2851 159.354 38.2851C161.302 38.2851 162.291 36.9756 163.09 34.9325L170.146 17.1504C170.401 16.4494 170.594 16.3843 172.029 15.8735V14.7568H165.899L165.897 14.7543Z" fill="currentColor"/>
                    <path d="M51.7429 29.5644C48.1349 29.5644 45.9015 26.7226 45.9015 22.5412H57.329V21.5522C57.329 17.3708 55.1256 14.4338 50.9117 14.4338C46.6978 14.4338 43.25 18.1695 43.25 23.7555C43.25 28.32 45.9967 31.9931 50.6563 31.9931C54.2317 31.9931 56.5928 29.95 57.359 27.1082L56.8157 26.8202C55.6339 28.3851 54.1341 29.5669 51.7404 29.5669L51.7429 29.5644ZM50.4335 15.9987C53.0499 15.9987 54.392 17.9467 54.392 21.0114H46.0292C46.2846 18.3623 47.9121 15.9987 50.436 15.9987H50.4335Z" fill="currentColor"/>
                    <path d="M106.649 29.5644C103.041 29.5644 100.808 26.7226 100.808 22.5412H112.235V21.5522C112.235 17.3708 110.032 14.4338 105.818 14.4338C101.414 14.4338 98.1562 18.1695 98.1562 23.7555C98.1562 28.32 100.903 31.9931 105.563 31.9931C109.138 31.9931 111.499 29.95 112.265 27.1082L111.722 26.8202C110.54 28.3851 109.04 29.5669 106.647 29.5669L106.649 29.5644ZM105.34 15.9987C107.956 15.9987 109.298 17.9467 109.298 21.0114H100.935C101.191 18.3623 102.818 15.9987 105.342 15.9987H105.34Z" fill="currentColor"/>
                    <path d="M75.1412 28.7356V14.4338H74.4401L73.5462 14.8169H64.6727V13.3472C64.6727 10.0271 66.205 8.46223 68.0253 8.46223C69.5576 8.46223 70.2287 9.06815 70.2287 10.6981V11.4969H72.0815C72.6874 11.1463 73.1681 10.5078 73.1681 9.70913C73.1681 8.01655 71.2527 7.22034 68.6362 7.22034C64.4549 7.22034 61.7407 10.0622 61.7407 14.1158V14.5615L59.3771 15.3928V16.4469H61.7407V28.7381C61.7407 30.2079 60.6866 30.3656 59.282 30.5584V31.6751H67.1365V30.5584C65.6993 30.3656 64.6777 30.2079 64.6777 28.7381V16.4469H72.2117V28.7381C72.2117 30.2079 71.1576 30.3656 69.7529 30.5584V31.6751H77.6074V30.5584C76.1702 30.3656 75.1487 30.2079 75.1487 28.7381L75.1412 28.7356Z" fill="currentColor"/>
                    <path d="M95.3495 28.7356V19.6693C95.3495 15.9336 93.6569 14.4338 90.8802 14.4338C88.1034 14.4338 86.3157 16.0288 84.7508 17.5636V14.4338H83.9521L79.5154 16.0288V16.6998L81.8139 17.8165V28.7356C81.8139 30.2054 80.7597 30.3631 79.3551 30.5559V31.6726H87.2071V30.5559C85.7699 30.3631 84.7483 30.2054 84.7483 28.7356V18.4875C85.9627 17.5286 87.7804 16.7949 89.4405 16.7949C91.4836 16.7949 92.41 17.5937 92.41 19.8922V28.7356C92.41 30.2054 91.3559 30.3631 89.9513 30.5559V31.6726H97.8358V30.5559C96.3986 30.3631 95.347 30.2054 95.347 28.7356H95.3495Z" fill="currentColor"/>
                    <path d="M138.272 29.1838C137.436 29.602 136.312 29.8899 135.348 29.8899C133.58 29.8899 132.809 29.279 132.809 27.5113V16.4444H137.737V14.7844H132.809L132.797 12.7162C132.754 11.4143 132.461 10.3727 131.83 9.4738C130.771 7.9665 128.886 7.12772 126.852 7.1778H126.735C124.704 7.12772 122.819 7.95899 121.762 9.46629C121.276 10.1573 120.991 10.9385 120.866 11.8549C120.866 11.8549 120.866 11.8624 120.866 11.8674C120.833 12.1178 120.811 12.4734 120.818 12.8064C120.826 13.1394 120.881 13.7528 121.079 14.2461C121.094 14.2811 121.114 14.3212 121.119 14.3412C120.748 14.3412 120.37 14.3062 120.01 14.3462C119.972 14.3512 119.939 14.3537 119.912 14.3587C116.807 14.5365 114.849 16.4995 114.849 19.1936C114.849 22.1181 116.745 23.3399 119.606 24.2388C122.498 25.1377 123.978 25.8463 123.978 27.9344C123.978 29.607 122.756 30.571 120.698 30.571C118.062 30.571 116.487 28.8984 115.846 26.1667H114.656L114.849 30.4408C116.424 31.6301 118.577 32.0157 120.666 32.0157C124.361 32.0157 126.645 29.8624 126.645 27.0331C126.645 23.7856 124.491 22.8216 121.276 21.8251C118.8 21.054 117.483 20.1225 117.483 18.3548C117.483 16.9076 118.545 15.816 120.28 15.816C122.561 15.816 124.008 17.1004 124.459 19.6718H125.678L125.666 15.3077V15.2651C125.598 15.2201 124.284 15.0874 123.502 14.4188C123.052 14.0333 122.749 13.4999 122.676 12.4609C122.669 12.1103 122.684 11.7573 122.726 11.4118C122.921 9.8694 124.243 8.67007 126.016 8.42971C126.257 8.39716 126.539 8.36711 126.797 8.36711C127.055 8.36711 127.331 8.40216 127.584 8.43722C129.356 8.67758 130.678 9.87441 130.874 11.4193C130.919 11.7648 130.931 12.1178 130.924 12.4684C130.851 13.5074 130.546 14.0408 130.097 14.4264C129.316 15.0949 128.002 15.2276 127.934 15.2726V16.4369H129.892V28.1147C129.89 30.8464 131.495 31.908 133.713 31.908C135.931 31.908 137.506 31.0717 138.598 29.8824L138.277 29.1763L138.272 29.1838Z" fill="currentColor"/>
                  </g>
                  <defs>
                    <clipPath id="clip0_152_6552_mobile">
                      <rect width="164" height="31.2977" fill="white" transform="translate(8 7)"/>
                    </clipPath>
                  </defs>
                </svg>
              </Link>
              <Link href="/manage" className="text-sm font-medium">
                Manage
              </Link>
              <Link href="/keys" className="text-sm font-medium">
                Keys
              </Link>
              <Link href="/profile" className="text-sm font-medium">
                My Profile
              </Link>
              <Link href="/settings" className="text-sm font-medium">
                Settings
              </Link>
              <div className="pt-2 border-t">
                <div className="flex items-center justify-between">
                  <span className="text-sm font-medium">Theme</span>
                  <ThemeToggle />
                </div>
              </div>
            </nav>
          </SheetContent>
        </Sheet>

        {/* Logo/Brand - Centered */}
        <Link href="/" className="absolute left-1/2 -translate-x-1/2 flex items-center gap-2">
          <svg width="180" height="46" viewBox="0 0 180 46" fill="none" xmlns="http://www.w3.org/2000/svg" className="h-6 md:h-8 w-auto">
            <g clipPath="url(#clip0_152_6552)">
              <path d="M40.4408 28.7356V19.6693C40.4408 15.9336 38.7482 14.4338 35.9715 14.4338C33.1947 14.4338 31.407 16.0288 29.8421 17.5636V14.4338H29.0434L24.6067 16.0288V16.6998L26.9052 17.8165V28.7356C26.9052 30.2054 25.8511 30.3631 24.4464 30.5559V31.6726H32.2984V30.5559C30.8612 30.3631 29.8396 30.2054 29.8396 28.7356V18.4875C31.0515 17.5286 32.8718 16.7949 34.5318 16.7949C36.5749 16.7949 37.5013 17.5937 37.5013 19.8922V28.7356C37.5013 30.2054 36.4472 30.3631 35.0426 30.5559V31.6726H42.9271V30.5559C41.4899 30.3631 40.4383 30.2054 40.4383 28.7356H40.4408Z" fill="currentColor"/>
              <path d="M153.896 29.8849C152.97 29.8849 152.429 29.1187 152.429 27.7141C152.429 26.3094 152.524 20.8511 152.524 19.797C152.524 16.3167 150.674 14.4338 147.001 14.4338C143.52 14.4338 140.934 15.9662 140.934 18.5827C140.934 19.3488 141.157 19.8596 141.605 20.3053L143.999 19.9873C143.838 19.3488 143.776 18.8706 143.776 18.3273C143.776 16.6998 144.67 15.9637 146.392 15.9637C148.884 15.9637 149.552 17.6562 149.552 19.5717V21.1366L144.509 22.9568C142.434 23.6905 140.073 24.712 140.073 27.6815C140.073 30.0126 141.415 31.9906 144.319 31.9906C146.68 31.9906 148.5 30.3957 149.65 29.0862C149.938 30.8113 150.734 31.9906 152.364 31.9906C153.481 31.9906 154.47 31.5424 155.556 30.4583L155.396 29.6921C154.918 29.8198 154.182 29.8824 153.896 29.8824V29.8849ZM149.555 28.32C148.215 29.309 147.128 29.7572 145.629 29.7572C144.001 29.7572 143.075 28.7356 143.075 26.9154C143.075 25.7035 143.841 24.7771 145.023 24.3289L149.555 22.6063V28.32Z" fill="currentColor"/>
              <path d="M15.8933 14.4338C11.5517 14.4338 7.94373 18.0418 7.94373 23.5327C7.94373 28.4502 10.9758 31.9931 15.7005 31.9931C20.0422 31.9931 23.6502 28.3851 23.6502 22.8942C23.6502 17.9767 20.618 14.4338 15.8933 14.4338ZM16.0836 30.3331C12.8587 30.3331 11.0084 26.9504 11.0084 22.9593C11.0084 18.9682 12.5082 16.0964 15.5103 16.0964C18.7352 16.0964 20.5855 19.479 20.5855 23.4701C20.5855 27.4612 19.0857 30.3331 16.0836 30.3331Z" fill="currentColor"/>
              <path d="M165.897 14.7543V15.871C167.524 16.0938 168.195 16.2541 168.195 17.0202C168.195 17.2756 168.13 17.4684 167.973 17.8815L164.047 28.2874L159.833 17.8815C159.64 17.4659 159.61 17.2756 159.61 17.0202C159.61 16.2541 160.248 16.0938 161.908 15.871V14.7543H154.437V15.871C155.874 16.4143 156.002 16.4769 156.32 17.1479L162.642 31.7702L162.004 33.4628C161.365 35.218 160.566 35.6661 158.556 35.6661H156.896V37.1359C157.407 37.8069 158.3 38.2851 159.354 38.2851C161.302 38.2851 162.291 36.9756 163.09 34.9325L170.146 17.1504C170.401 16.4494 170.594 16.3843 172.029 15.8735V14.7568H165.899L165.897 14.7543Z" fill="currentColor"/>
              <path d="M51.7429 29.5644C48.1349 29.5644 45.9015 26.7226 45.9015 22.5412H57.329V21.5522C57.329 17.3708 55.1256 14.4338 50.9117 14.4338C46.6978 14.4338 43.25 18.1695 43.25 23.7555C43.25 28.32 45.9967 31.9931 50.6563 31.9931C54.2317 31.9931 56.5928 29.95 57.359 27.1082L56.8157 26.8202C55.6339 28.3851 54.1341 29.5669 51.7404 29.5669L51.7429 29.5644ZM50.4335 15.9987C53.0499 15.9987 54.392 17.9467 54.392 21.0114H46.0292C46.2846 18.3623 47.9121 15.9987 50.436 15.9987H50.4335Z" fill="currentColor"/>
              <path d="M106.649 29.5644C103.041 29.5644 100.808 26.7226 100.808 22.5412H112.235V21.5522C112.235 17.3708 110.032 14.4338 105.818 14.4338C101.414 14.4338 98.1562 18.1695 98.1562 23.7555C98.1562 28.32 100.903 31.9931 105.563 31.9931C109.138 31.9931 111.499 29.95 112.265 27.1082L111.722 26.8202C110.54 28.3851 109.04 29.5669 106.647 29.5669L106.649 29.5644ZM105.34 15.9987C107.956 15.9987 109.298 17.9467 109.298 21.0114H100.935C101.191 18.3623 102.818 15.9987 105.342 15.9987H105.34Z" fill="currentColor"/>
              <path d="M75.1412 28.7356V14.4338H74.4401L73.5462 14.8169H64.6727V13.3472C64.6727 10.0271 66.205 8.46223 68.0253 8.46223C69.5576 8.46223 70.2287 9.06815 70.2287 10.6981V11.4969H72.0815C72.6874 11.1463 73.1681 10.5078 73.1681 9.70913C73.1681 8.01655 71.2527 7.22034 68.6362 7.22034C64.4549 7.22034 61.7407 10.0622 61.7407 14.1158V14.5615L59.3771 15.3928V16.4469H61.7407V28.7381C61.7407 30.2079 60.6866 30.3656 59.282 30.5584V31.6751H67.1365V30.5584C65.6993 30.3656 64.6777 30.2079 64.6777 28.7381V16.4469H72.2117V28.7381C72.2117 30.2079 71.1576 30.3656 69.7529 30.5584V31.6751H77.6074V30.5584C76.1702 30.3656 75.1487 30.2079 75.1487 28.7381L75.1412 28.7356Z" fill="currentColor"/>
              <path d="M95.3495 28.7356V19.6693C95.3495 15.9336 93.6569 14.4338 90.8802 14.4338C88.1034 14.4338 86.3157 16.0288 84.7508 17.5636V14.4338H83.9521L79.5154 16.0288V16.6998L81.8139 17.8165V28.7356C81.8139 30.2054 80.7597 30.3631 79.3551 30.5559V31.6726H87.2071V30.5559C85.7699 30.3631 84.7483 30.2054 84.7483 28.7356V18.4875C85.9627 17.5286 87.7804 16.7949 89.4405 16.7949C91.4836 16.7949 92.41 17.5937 92.41 19.8922V28.7356C92.41 30.2054 91.3559 30.3631 89.9513 30.5559V31.6726H97.8358V30.5559C96.3986 30.3631 95.347 30.2054 95.347 28.7356H95.3495Z" fill="currentColor"/>
              <path d="M138.272 29.1838C137.436 29.602 136.312 29.8899 135.348 29.8899C133.58 29.8899 132.809 29.279 132.809 27.5113V16.4444H137.737V14.7844H132.809L132.797 12.7162C132.754 11.4143 132.461 10.3727 131.83 9.4738C130.771 7.9665 128.886 7.12772 126.852 7.1778H126.735C124.704 7.12772 122.819 7.95899 121.762 9.46629C121.276 10.1573 120.991 10.9385 120.866 11.8549C120.866 11.8549 120.866 11.8624 120.866 11.8674C120.833 12.1178 120.811 12.4734 120.818 12.8064C120.826 13.1394 120.881 13.7528 121.079 14.2461C121.094 14.2811 121.114 14.3212 121.119 14.3412C120.748 14.3412 120.37 14.3062 120.01 14.3462C119.972 14.3512 119.939 14.3537 119.912 14.3587C116.807 14.5365 114.849 16.4995 114.849 19.1936C114.849 22.1181 116.745 23.3399 119.606 24.2388C122.498 25.1377 123.978 25.8463 123.978 27.9344C123.978 29.607 122.756 30.571 120.698 30.571C118.062 30.571 116.487 28.8984 115.846 26.1667H114.656L114.849 30.4408C116.424 31.6301 118.577 32.0157 120.666 32.0157C124.361 32.0157 126.645 29.8624 126.645 27.0331C126.645 23.7856 124.491 22.8216 121.276 21.8251C118.8 21.054 117.483 20.1225 117.483 18.3548C117.483 16.9076 118.545 15.816 120.28 15.816C122.561 15.816 124.008 17.1004 124.459 19.6718H125.678L125.666 15.3077V15.2651C125.598 15.2201 124.284 15.0874 123.502 14.4188C123.052 14.0333 122.749 13.4999 122.676 12.4609C122.669 12.1103 122.684 11.7573 122.726 11.4118C122.921 9.8694 124.243 8.67007 126.016 8.42971C126.257 8.39716 126.539 8.36711 126.797 8.36711C127.055 8.36711 127.331 8.40216 127.584 8.43722C129.356 8.67758 130.678 9.87441 130.874 11.4193C130.919 11.7648 130.931 12.1178 130.924 12.4684C130.851 13.5074 130.546 14.0408 130.097 14.4264C129.316 15.0949 128.002 15.2276 127.934 15.2726V16.4369H129.892V28.1147C129.89 30.8464 131.495 31.908 133.713 31.908C135.931 31.908 137.506 31.0717 138.598 29.8824L138.277 29.1763L138.272 29.1838Z" fill="currentColor"/>
            </g>
            <defs>
              <clipPath id="clip0_152_6552">
                <rect width="164" height="31.2977" fill="white" transform="translate(8 7)"/>
              </clipPath>
            </defs>
          </svg>
        </Link>

        {/* Search Bar - Desktop Only (hidden on mobile, mobile search is in FixedSearchBar) */}
        <div className="flex-1 flex justify-center">
          <SearchBar onSearch={handleSearch} className="hidden md:block" />
        </div>

        {/* Action Items - Right Side */}
        <div className="flex items-center gap-2">

          {/* Notifications */}
          <Button variant="ghost" size="icon" asChild>
            <Link href="/notifications" className="relative">
              <Bell className="h-5 w-5" />
              <Badge 
                variant="destructive" 
                className="absolute -top-1 -right-1 h-5 w-5 p-0 flex items-center justify-center text-xs"
              >
                3
              </Badge>
            </Link>
          </Button>

          {/* Desktop Action Items */}
          <div className="hidden md:flex items-center gap-2">
            <Button variant="ghost" size="sm" asChild>
              <Link href="/manage">Manage</Link>
            </Button>
            <Button variant="ghost" size="sm" asChild>
              <Link href="/keys">
                <Key className="h-4 w-4 mr-2" />
                Keys
              </Link>
            </Button>
          </div>

          {/* User Menu */}
          <DropdownMenu>
            <DropdownMenuTrigger asChild>
              <Button variant="ghost" className="relative h-10 w-10 rounded-full">
                <Avatar className="h-10 w-10">
                  <AvatarFallback>U</AvatarFallback>
                </Avatar>
              </Button>
            </DropdownMenuTrigger>
            <DropdownMenuContent align="end" className="w-56">
              <DropdownMenuLabel>
                {userEmail || "My Account"}
              </DropdownMenuLabel>
              <DropdownMenuSeparator />
              <DropdownMenuItem asChild>
                <Link href="/profile" className="flex items-center">
                  <User className="mr-2 h-4 w-4" />
                  My Profile
                </Link>
              </DropdownMenuItem>
              <DropdownMenuItem asChild>
                <Link href="/settings" className="flex items-center">
                  <Settings className="mr-2 h-4 w-4" />
                  Settings
                </Link>
              </DropdownMenuItem>
              <DropdownMenuSeparator />
              <div className="px-2 py-1.5">
                <div className="flex items-center justify-between">
                  <span className="text-sm font-medium">Theme</span>
                  <ThemeToggle />
                </div>
              </div>
              <DropdownMenuSeparator />
              <DropdownMenuItem onClick={handleLogout}>
                Log out
              </DropdownMenuItem>
            </DropdownMenuContent>
          </DropdownMenu>
        </div>
      </div>
    </header>
  )
}

